<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_partner_form_inherit" model="ir.ui.view">
        <field name="name">res.partner.form.inherit</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_partner_form"/>
        <field name="arch" type="xml">
              <xpath expr="//field[@name='child_ids']/form/sheet/group" position="after">
             <group string="Informations supplémentaires">
                    <field name="prenom"/>
                    <field name="site_location"/>
                    <field name="influence"/>
                    <field name="observation"/>
                </group>
        </xpath>
            <xpath expr="//field[@name='website']" position="after">
                <field name="secteur_activite"/>
                <field name="nbr_site"/>
                <field name="in_company_1" invisible="1"/>
                <field name="special_conditions" invisible="customer_rank == 0"/>
                <field name="gold_vip" invisible="customer_rank == 0"/>
            </xpath>
            <xpath expr="//notebook" position="inside">
             <page string="Interlocuteurs côté client" invisible="not in_company_1">
                <h3>Liste des acheteurs, commerciaux, ADV, logistique, finance, direction...</h3>
                <field name="child_ids">
                    <list editable="bottom">
                        <field name="name"/>
                        <field name="title"/>
                        <field name="function"/>
                        <field name="email"/>
                        <field name="phone"/>
                        <field name="mobile"/>
                        <field name="site_location"/>
                        <field name="influence"/>
                        <field name="observation"/>
                    </list>
                </field>
            </page>
                   <page string="Équipe interne" invisible="customer_rank == 0 or not in_company_1">
        <group>
            <group>
                <field name="commercial_id"/>
                <field name="autres_commerciaux_ids" widget="many2many_tags"/>
            </group>
            <group>
                <field name="responsable_projet_id"/>
                <field name="referent_logistique_id"/>
                <field name="referent_facturation_id"/>
            </group>
        </group>
    </page>
                 <page string="Classification client" invisible="customer_rank == 0 or not in_company_1">
        <group>
            <group>
                <field name="budget_ids" widget="many2many_tags" options="{'color_field': 'color'}"/>
                <field name="color" invisible="1"/>

                <field name="statut_relationnel"/>
                <field name="potentiel_strategique"/>
                <field name="zone"/>
                <field name="produits"/>
            </group>
            <group>
                <field name="type_client"/>
                <field name="pays_zone"/>
                <field name="region_zone"/>
            </group>
        </group>
    </page>
                  <page string="Historique et Suivi" invisible="customer_rank == 0 or not in_company_1">
                <group>
                    <field name="ca_cumule"/>
                    <field name="commandes_nb"/>
                    <field name="commandes_montant"/>
                    <field name="produits_achetes"/>
                    <field name="derniere_interaction_date"/>
                    <field name="derniere_interaction_type"/>
                    <field name="prochaine_action_date"/>
                    <field name="prochaine_action_responsable_id"/>
                    <field name="prochaine_action_type"/>
                </group>
            </page>
                 <page string="Conditions Commerciales" invisible="not in_company_1">
                <group>
                    <field name="discount_conditions" placeholder="[% ou conditions]" />
                    <field name="payment_term_id" invisible="customer_rank == 0 or not in_company_1"/>
                    <field name="purchase_payment_term_id"  invisible="supplier_rank == 0 or not in_company_1"/>
                    <field name="incoterm_id" placeholder="Incoterm, transporteur habituel…" />
                    <field name="contract_particularities" placeholder="Contrat cadre, exclusivité, NDA…" />
                </group>
            </page>
                     <page string="Satisfaction et Suivi Qualité" invisible="customer_rank == 0 or not in_company_1">

                <group>
                    <field name="satisfaction_score"/>
                </group>

                <group>
                    <field name="feedbacks"/>
                </group>

                <group>
                    <field name="improvement_points"/>
                </group>

            </page>

                <page string="Suivi qualité et conformité" invisible="supplier_rank == 0 or not in_company_1">

                <group>
                    <field name="satisfaction_score"/>
                </group>

                <group>
            <field name="certification_ids" widget="many2many_tags"/>
        </group>
        <group>
            <field name="quality_incident_ids">
                <list editable="bottom">
                    <field name="date_incident"/>
                    <field name="description"/>
                </list>
            </field>
        </group>

                <group>
                    <field name="improvement_points"/>
                </group>

            </page>

<!--                nootbook_fornisseur-->
                <page string="Équipe Interne" invisible="supplier_rank == 0 or not in_company_1">

                <group>
                    <field name="purchase_responsible_id"/>
                    <field name="other_buyers_ids" widget="many2many_tags"/>
                </group>

                <group>
                    <field name="quality_ref_id"/>
                    <field name="logistic_ref_id"/>
                    <field name="billing_ref_id"/>
                </group>

            </page>
            <page string="Classification fournisseur" invisible="supplier_rank == 0 or not in_company_1">
                <group>
                    <group>
                <!-- Fiabilité avec badge coloré -->
                <field name="supplier_fiability" widget="many2many_tags"
                       options="{'color_field': 'color'}"/>

                <field name="supplier_dependence"/></group>
                    <group>
                <field name="supplier_type"/>
                <field name="supplier_zone"/></group></group>
            </page>
                <page string="Historique et Suivi" invisible="supplier_rank == 0 or not in_company_1">
                <group>
                    <field name="volume_achats_cumule" readonly="1"/>
                    <field name="commandes_passees_count" readonly="1"/>
                    <field name="commandes_passees_montant" readonly="1"/>
                </group>
                <group>
                    <field name="produits_fournis_ids" widget="many2many_tags" readonly="1"/>
                </group>
                <group>
                    <field name="derniere_interaction" readonly="1"/>
                    <field name="prochaine_action" readonly="1"/>
                </group>
            </page>

        </xpath>
        </field>
    </record>

    <record id="view_partner_tree_inherit_status" model="ir.ui.view">
        <field name="name">res.partner.tree.inherit.status</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_partner_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='city']" position="after">
                <field name="secteur_activite"/>
                <field name="nbr_site"/>
            </xpath>
        </field>
    </record>
<!--<record model="ir.ui.view" id="res_partner_kanban_view_inherit_budget">-->
<!--    <field name="name">res.partner.kanban.inherit.budget</field>-->
<!--    <field name="model">res.partner</field>-->
<!--    <field name="inherit_id" ref="base.res_partner_kanban_view"/>-->
<!--    <field name="arch" type="xml">-->


<!--        &lt;!&ndash; Affichage coloré dans le footer &ndash;&gt;-->
<!--        <xpath expr="//footer/div" position="inside">-->
<!--    <t t-foreach="record.budget_ids" t-as="b">-->
<!--        <span t-att-style="'background-color:%s;color:white;padding:2px 5px;border-radius:3px;margin-right:2px;' % (b['color'] or '#777')">-->
<!--            <t t-esc="b['name']"/>-->
<!--        </span>-->
<!--    </t>-->
<!--</xpath>-->


<!--    </field>-->
<!--</record>-->
    <record id="view_partner_kanban_inherit_budget" model="ir.ui.view">
        <field name="name">res.partner.kanban.budget</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.res_partner_kanban_view"/>
        <field name="arch" type="xml">
            <xpath expr="//kanban" position="inside">
                <t t-if="record.gold_vip_text.raw_value">
                    <span class="badge badge-warning">
                        <t t-esc="record.gold_vip_text.raw_value"/>
                    </span>
                </t>
            </xpath>
            <xpath expr="//footer/div" position="inside">

                <field name="budget_ids" widget="many2many_tags" options="{'color_field': 'color'}"
                       invisible="customer_rank == 0 or not in_company_1"/>
                <field name="supplier_fiability" widget="many2many_tags" options="{'color_field': 'color'}"
                       invisible="supplier_rank == 0 or not in_company_1"/>
                                <div invisible="supplier_rank == 0 or not in_company_1">

                        <b>ND: </b>

                    <field name="supplier_dependence"/>
                </div><div invisible="supplier_rank == 0 or not in_company_1">

                        <b>Type: </b>

                    <field name="supplier_type"/>
                </div>


                <div invisible="customer_rank == 0 or not in_company_1">
                    <span>
                        <b>CA cumulé :</b>
                    </span>
                    <field name="ca_cumule"/>
                </div>

                <div invisible="customer_rank == 0 or not in_company_1">
                    <span>
                        <b>Commandes passées :</b>
                    </span>
                    <field name="commandes_nb"/>
                </div>

                <div invisible="customer_rank == 0 or not in_company_1">
                    <span>
                        <b>Montant commandes :</b>
                    </span>
                    <field name="commandes_montant"/>
                </div>
                <div invisible="customer_rank == 0 or not in_company_1">
                    <span>
                        <b>Statut Relationnel :</b>
                    </span>
                    <field name="statut_relationnel"/>
                </div>
                <div invisible="customer_rank == 0 or not in_company_1">
                    <span>
                        <b>Potentiel Strategique :</b>
                    </span>
                    <field name="potentiel_strategique"/>
                </div>
                <div invisible="customer_rank == 0 or not in_company_1">
                    <span>
                        <b>Zone :</b>
                    </span>
                    <field name="zone"/>
                </div>
                <div invisible="customer_rank == 0 or not in_company_1">
                    <span>
                        <b>Produits :</b>
                    </span>
                    <field name="produits"/>
                </div>
            </xpath>
        </field>
    </record>

<!--    <record id="view_partner_filter_custom" model="ir.ui.view">-->
<!--    <field name="name">res.partner.filter.name</field>-->
<!--    <field name="model">res.partner</field>-->
<!--    <field name="inherit_id" ref="base.view_res_partner_filter"/>-->
<!--    <field name="arch" type="xml">-->
<!--    <filter name="type_company" position="after">-->
<!--    <separator/>-->
<!--&lt;!&ndash;    <filter string="Fournisseurs stratégiques ISO"&ndash;&gt;-->
<!--&lt;!&ndash;            domain="[('supplier_rank','>',0), ('certification_ids','ilike','ISO')]"/>&ndash;&gt;-->
<!--&lt;!&ndash;    <filter string="Sous-traitants incidents qualité"&ndash;&gt;-->
<!--&lt;!&ndash;            domain="[('supplier_rank','>',0), ('supplier_type','=','Sous-traitant'), ('quality_incident_ids','!=',False)]"/>&ndash;&gt;-->
<!--    <filter string="Fournisseurs alternatifs par zone"-->
<!--            domain="[('supplier_rank','>',0), ('supplier_dependence','=','Alternatif'), ('zone','!=',False)]"/>-->
<!--    <filter string="Fournisseurs clés matière première"-->
<!--            domain="[('supplier_rank','>',0), ('supplier_dependence','=','Strategique'), ('supplier_type','=','Matière première')]"/>-->
<!--    <filter string="Fournisseurs paiement favorable"-->
<!--            domain="[('supplier_rank','>',0), ('payment_term_id','in',[1,2])]"/>-->
<!--    </filter>-->
<!--    </field>-->
<!--</record>-->

</odoo>
