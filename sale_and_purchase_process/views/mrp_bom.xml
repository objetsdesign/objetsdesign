<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Wizard Form -->
    <record id="view_sale_bom_wizard_form" model="ir.ui.view">
        <field name="name">sale.bom.wizard.form</field>
        <field name="model">sale.bom.wizard</field>
        <field name="arch" type="xml">
            <form string="Sélection des composants à acheter">
                <group>
                    <field name="sale_id" readonly="1"/>
                    <field name="order_line_ids" widget="many2many_tags" readonly="0"/>
<!--                    <field name="vendor_id"/>-->
                </group>

                <group>
                    <field name="bom_line_ids" widget="many2many_tags" options="{'no_create_edit': True}"/>
                </group>

                <field name="bom_line_ids" nolabel="1" context="{'no_open': 1}">
        <list editable="bottom">
            <field name="product_id" readonly="1"/>
            <field name="product_qty"/>
            <field name="product_uom_id"/>
            <field name="component_price"/>
            <field name="partner_id"/>
        </list>
    </field>

                <footer>
                    <button string="Ajouter dans Bon d'Achat"
                            type="object"
                            name="action_create_purchase_order"
                            class="btn-primary"/>
                    <button string="Annuler" special="cancel" class="btn-secondary"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- Action d'ouverture du wizard -->
    <record id="action_sale_bom_wizard" model="ir.actions.act_window">
        <field name="name">Sélection Composants</field>
        <field name="res_model">sale.bom.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="context">{}</field>
    </record>

    <!-- Bouton dans la commande client -->
    <record id="view_order_form_inherit_bom_wizard" model="ir.ui.view">
        <field name="name">sale.order.form.bom.wizard.button</field>
        <field name="model">sale.order</field>
        <field name="inherit_id" ref="sale.view_order_form"/>
        <field name="arch" type="xml">
            <header position="inside">
                <button name="%(action_sale_bom_wizard)d"
        string="Sélection Composants à acheter"
        type="action"
        class="btn-primary" groups="sale_and_purchase_process.group_bom_access"
       />
            </header>
            <xpath expr="//field[@name='partner_id']" position="before">
                <field name="order_type" widget="radio"/>
                <field name="product_category_type" widget="radio"/>


            </xpath>
        </field>
    </record>
<record id="view_bom_form_inherit_price" model="ir.ui.view">
    <field name="name">mrp.bom.form.inherit.price</field>
    <field name="model">mrp.bom</field>
    <field name="inherit_id" ref="mrp.mrp_bom_form_view"/>
    <field name="arch" type="xml">
        <xpath expr="//field[@name='bom_line_ids']/list" position="inside">
            <field name="component_price" readonly="0"/>
            <field name="partner_id"/>
        </xpath>
    </field>
</record>

</odoo>
